---
title: 《深入理解Java虚拟机》第三章
description: 垃圾收集器与内存分配策略
categories:
- 《深入理解Java虚拟机》读书笔记
tags: 
- 读书笔记
- JVM
---

## 3.1 概述

垃圾回收需要完成的三件事情：
* 哪些内存需要回收?
* 什么时候回收?
* 如何回收?

> **为什么我们还要去了解垃圾收集和内存分配?**当需要排查各种内存溢出、内存泄漏问题时，当垃圾收集成为系统达到更高并发量的瓶颈时，我们就必须对这些“自动 化”的技术实施必要的监控和调节。

每一个栈帧中分配多少内存基 本上是在类结构确定下来时就**已知的**；而**Java堆和方法区**这两个区域则有着很显著的**不确定性**，只有处于运行期间，我们才 能知道程序究竟会创建哪些对象，创建多少个对象，这部分内存的分配和回收是动态的。

## 3.2 对象已死？

### 3.2.1 引用计数法

**算法描述**：在对象中添加一个引用计数器，每当有一个地方 引用它时，计数器值就加一;当引用失效时，计数器值就减一;任何时刻计数器为零的对象就是不可 能再被使用的。

**特点**：原理简单，判定效率也很高，在大多数情况下它都是一个不错的算法。

**Java领域**主流的Java虚拟机里面都没有选用引用计数算法来管理内存，**原因是**有很多例外情况要考虑，必须要配合大量额外处理才能保证正确地工作，譬如单纯的引用计数 就很难解决对象之间相互**循环引用**的问题。

### 3.2.2 可达性分析算法

当前主流商用程序语言的内容管理子系统使用的算法

**算法描述**：从**GC Root**搜索，走过的路径称为**引用链**，没有与引用链相连，则是不再被使用的

<img src="https://cdn.jsdelivr.net/gh/qqqjoe/imageRepo@latest/202112151850216.png"/>